# kCON

kCON is a scalable and transferable deep learning framework for chemistry with the ability to provide insight into atomistic structures of varying stoichiometry from small and scrap training sets.

* Author: Xin Chen
* Email: Bismarrck@me.com

![Alt text]()(doc/images/figure1?raw=true “The general structure of kCON”)

### 1. Related work

* Exploring atomic chemistry with machine learning

### 2. Requirements

All codes are written in Python3.6. Some codes can be executed perfectly under Python2.7.x.

1. tensorflow\>=1.2
2. numpy
3. scipy
4. jupyter
5. matplotlib
6. scikit-learn
7. ase\>=3.12

### 3. Datasets

In order to pull these dataset files from github, **[Git LFS][2]** should be installed.

### 4. Modules

This project is organized like other projects under [tensorflow/models][3].

#### Model

1. `inference.py`: for the detailed implementation of the **KCNN** model.
2. `kcnn.py`: for constructing **KCNN** model and building the loss function for CPU/single-GPU training.
3. `transformer.py`: for transforming [`ase.Atoms`][4] to input features of the model.
4. `save_model.py`: for freezing and exporting trained model to `pb` files.

#### Training and validation

1. `train.py`: the CPU/single-GPU version of training.
2. `multi_gpu_train.py`: for training on a single node with multiple GPUs.
3. `distributed_train.py`:  for training on distributed systems. **Not implemented yet**.
4. `evaludation.py`: for continuously evaluating the training performance.

#### I/O

1. `database.py`: for parsing xyz files and managing the sqlite database files generated by [`ase.db`][5].
2. `reader.py`: for reading [TensorFlow Records][6] files to build input pipelines for training.
	- TensorFlow 1.3 introduces `tf.contrib.data.Dataset` API which is easier to use. So this module will be upgraded later.

#### Prediction

1. `predictor.py`: for making predictions using trained models.
2. `calculator.py`: an [`ase.calculator.Calculator`][7] wrapper of `KcnnPredictor`.

#### Auxiliary Files

1. `constants.py`: global constants are defined in this module.
2. `utils.py`: some helper functions are defined in this module.

[2]:	https://git-lfs.github.com
[3]:	https://github.com/tensorflow/models
[4]:	https://wiki.fysik.dtu.dk/ase/ase/atoms.html
[5]:	https://wiki.fysik.dtu.dk/ase/ase/db/db.html#ase-db
[6]:	https://www.tensorflow.org/versions/r1.1/programmers_guide/reading_data
[7]:	https://wiki.fysik.dtu.dk/ase/ase/calculators/calculators.html